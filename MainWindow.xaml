<Window x:Class="MonitorSwitcher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MonitorSwitcher"
        Title="Monitor Switcher"
        Width="340"
        Height="Auto"
        SizeToContent="Height"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ShowInTaskbar="False"
        Topmost="True"
        ResizeMode="NoResize"
        Deactivated="Window_Deactivated">
    
    <Window.Resources>
        <local:BoolToVisibilityConverter x:Key="BoolToVisibility"/>
        <local:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibility"/>
        <!-- Modern Windows 11 style button -->
        <Style x:Key="MonitorButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#2D2D2D"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="8"
                                Padding="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3D3D3D"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#4D4D4D"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Primary monitor style -->
        <Style x:Key="PrimaryMonitorStyle" TargetType="Button" BasedOn="{StaticResource MonitorButtonStyle}">
            <Setter Property="Background" Value="#0078D4"/>
        </Style>
    </Window.Resources>
    
    <!-- Main container with Windows 11 style -->
    <Border Background="{DynamicResource AppBackgroundBrush}" 
            CornerRadius="12" 
            BorderBrush="{DynamicResource BorderBrush}" 
            BorderThickness="1"
            Margin="8">
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" ShadowDepth="4" Opacity="0.4" Color="Black"/>
        </Border.Effect>
        
        <Grid>
            <StackPanel>
                <!-- Header -->
                <Border Background="{DynamicResource SurfaceBrush}" CornerRadius="12,12,0,0" Padding="16,12">
                    <Grid>
                        <TextBlock Text="Monitor Switcher" 
                                   FontSize="14" 
                                   FontWeight="SemiBold" 
                                   Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <TextBlock x:Name="StatusText" 
                                   Text="Click a monitor to set as primary" 
                                   FontSize="11" 
                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                   HorizontalAlignment="Right"/>
                    </Grid>
                </Border>
                
                <!-- Visual Monitor Layout -->
                <Border Background="{DynamicResource AppBackgroundBrush}" Padding="16">
                    <Canvas x:Name="MonitorCanvas" Width="300" Height="120" ClipToBounds="True">
                        <!-- Monitor items will be added programmatically -->
                    </Canvas>
                </Border>
                
                <!-- Monitor List -->
                <ItemsControl x:Name="MonitorList" Margin="8,0,8,8">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button Style="{StaticResource MonitorButtonStyle}"
                                    Margin="0,4"
                                    Click="MonitorButton_Click"
                                    Tag="{Binding}">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border" 
                                                Background="{DynamicResource SurfaceBrush}" 
                                                CornerRadius="8"
                                                Padding="12,10"
                                                Cursor="Hand">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="32"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <!-- Display Number -->
                                                <Border Grid.Column="0" 
                                                        Width="28" Height="28" 
                                                        CornerRadius="6"
                                                        Background="{DynamicResource AccentBrush}"
                                                        Visibility="{Binding IsPrimary, Converter={StaticResource BoolToVisibility}}">
                                                    <TextBlock Text="{Binding DisplayNumber}" 
                                                               FontWeight="Bold" 
                                                               FontSize="14"
                                                               Foreground="White"
                                                               HorizontalAlignment="Center" 
                                                               VerticalAlignment="Center"/>
                                                </Border>
                                                <Border Grid.Column="0" 
                                                        Width="28" Height="28" 
                                                        CornerRadius="6"
                                                        Background="{DynamicResource MonitorIconBackgroundBrush}"
                                                        Visibility="{Binding IsPrimary, Converter={StaticResource InverseBoolToVisibility}}">
                                                    <TextBlock Text="{Binding DisplayNumber}" 
                                                               FontWeight="Bold" 
                                                               FontSize="14"
                                                               Foreground="White"
                                                               HorizontalAlignment="Center" 
                                                               VerticalAlignment="Center"/>
                                                </Border>
                                                
                                                <!-- Monitor Info -->
                                                <StackPanel Grid.Column="1" Margin="10,0,0,0" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding DeviceName}" 
                                                               FontSize="13" 
                                                               FontWeight="Medium"
                                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                    <TextBlock FontSize="11" Foreground="{DynamicResource TextSecondaryBrush}">
                                                        <Run Text="{Binding Width, Mode=OneWay}"/>
                                                        <Run Text="×"/>
                                                        <Run Text="{Binding Height, Mode=OneWay}"/>
                                                        <Run Text="•"/>
                                                        <Run Text="{Binding Orientation, Mode=OneWay}"/>
                                                    </TextBlock>
                                                </StackPanel>
                                                
                                                <!-- Status -->
                                                <StackPanel Grid.Column="2" VerticalAlignment="Center">
                                                    <TextBlock Text="PRIMARY" 
                                                               FontSize="10" 
                                                               FontWeight="Bold"
                                                               Foreground="{DynamicResource AccentBrush}"
                                                               Visibility="{Binding IsPrimary, Converter={StaticResource BoolToVisibility}}"/>
                                                    <TextBlock Text="DISABLED" 
                                                               FontSize="10" 
                                                               Foreground="{DynamicResource TextSecondaryBrush}"
                                                               Visibility="{Binding IsEnabled, Converter={StaticResource InverseBoolToVisibility}}"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="{DynamicResource SurfaceHoverBrush}"/>
                                            </Trigger>
                                            <DataTrigger Binding="{Binding IsEnabled}" Value="False">
                                                <Setter TargetName="border" Property="Opacity" Value="0.5"/>
                                            </DataTrigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
                
                <!-- Footer -->
                <Border Background="{DynamicResource SurfaceBrush}" CornerRadius="0,0,12,12" Padding="12,8">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <Button Grid.Column="0"
                                Content="⟳ Refresh" 
                                Style="{StaticResource MonitorButtonStyle}"
                                Background="Transparent"
                                Foreground="{DynamicResource TextPrimaryBrush}"
                                FontSize="12"
                                Click="RefreshButton_Click"/>
                                
                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <Button Content="⚙ Theme" 
                                    Style="{StaticResource MonitorButtonStyle}"
                                    Background="Transparent"
                                    Foreground="{DynamicResource TextPrimaryBrush}"
                                    FontSize="12"
                                    Margin="0,0,8,0"
                                    Click="ThemeButton_Click">
                                <Button.ContextMenu>
                                    <ContextMenu Background="{DynamicResource SurfaceBrush}" 
                                                 BorderBrush="{DynamicResource BorderBrush}">
                                        <MenuItem Header="System Default" Click="ThemeMenuItem_Click" Tag="System"/>
                                        <MenuItem Header="Light" Click="ThemeMenuItem_Click" Tag="Light"/>
                                        <MenuItem Header="Dark" Click="ThemeMenuItem_Click" Tag="Dark"/>
                                    </ContextMenu>
                                </Button.ContextMenu>
                            </Button>
                            
                            <Button Content="✕ Exit" 
                                    Style="{StaticResource MonitorButtonStyle}"
                                    Background="Transparent"
                                    Foreground="{DynamicResource TextPrimaryBrush}"
                                    FontSize="12"
                                    Click="ExitButton_Click"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </StackPanel>
            
            <!-- Loading Overlay -->
            <Grid x:Name="LoadingOverlay" Background="{DynamicResource AppBackgroundBrush}" Visibility="Collapsed">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <ProgressBar IsIndeterminate="True" Width="150" Height="4" Background="{DynamicResource SurfaceBrush}" BorderThickness="0" Foreground="{DynamicResource AccentBrush}"/>
                    <TextBlock Text="Loading monitors..." Margin="0,12,0,0" Foreground="{DynamicResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>
